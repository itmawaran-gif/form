<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MAWARAN CO</title>

<style>
body{
  font-family:Tahoma;
  background:#f2f2f2;
  padding:10px;
}
.box{
  background:#fff;
  padding:15px;
  border-radius:10px;
  max-width:420px;
  margin:auto;
}
input,select,textarea,button{
  width:100%;
  margin-top:8px;
  padding:10px;
  font-size:14px;
}
button{
  background:#007bff;
  color:#fff;
  border:none;
  border-radius:6px;
}
.preview img{
  max-width:100%;
  margin-top:8px;
  border-radius:6px;
}
</style>
</head>

<body>

<div class="box">
  <h3>MAWARAN CO</h3>

  <input id="rep" placeholder="اسم المندوب">
  <input id="city" placeholder="المدينة">

  <input id="trade" placeholder="الاسم التجاري">
  <input id="owner" placeholder="اسم المالك">
  <input id="address" placeholder="العنوان">
  <input id="phone" placeholder="الهاتف">

  <select id="category">
    <option value="">الفئة</option>
    <option>كراج</option>
    <option>جملة</option>
    <option>مفرد</option>
  </select>

  <textarea id="note" placeholder="ملاحظات"></textarea>

  <select id="rating">
    <option value="">التقييم</option>
    <option value="1">⭐</option>
    <option value="2">⭐⭐</option>
    <option value="3">⭐⭐⭐</option>
    <option value="4">⭐⭐⭐⭐</option>
    <option value="5">⭐⭐⭐⭐⭐</option>
  </select>

  <input id="visitDays" type="number" placeholder="أيام الزيارة">
  <input id="useOil" placeholder="يستخدم زيت">
  <input id="oilType" placeholder="نوع الزيت">
  <input id="oilGrade" placeholder="درجة الزيت">
  <input id="distance" placeholder="المسافة">
  <input id="price" placeholder="السعر">

  <input id="image" type="file" accept="image/*" capture="environment">
  <div class="preview" id="preview"></div>

  <button onclick="send()">إرسال</button>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzzqLx7ENWeHNJMfPdR5Dc_EPvdVnjBJiocHIe9lfH2dHVtQQUsXqsjJaz8XMo81SvtTA/exec";
let imageBase64 = "";

image.onchange = () => {
  const file = image.files[0];
  const reader = new FileReader();
  reader.onload = () => {
    imageBase64 = reader.result;
    preview.innerHTML = `<img src="${imageBase64}">`;
  };
  reader.readAsDataURL(file);
};

function send(){
  navigator.geolocation.getCurrentPosition(pos=>{
    const data = new URLSearchParams({
      rep: rep.value,
      city: city.value,
      trade: trade.value,
      owner: owner.value,
      address: address.value,
      phone: phone.value,
      category: category.value,
      note: note.value,
      rating: rating.value,
      visitDays: visitDays.value,
      useOil: useOil.value,
      oilType: oilType.value,
      oilGrade: oilGrade.value,
      distance: distance.value,
      price: price.value,
      lat: pos.coords.latitude,
      lng: pos.coords.longitude,
      imageBase64: imageBase64
    });

    fetch(SCRIPT_URL,{
      method:"POST",
      headers:{ "Content-Type":"application/x-www-form-urlencoded" },
      body:data.toString()
    })
    .then(()=>alert("تم الإرسال بنجاح"))
    .catch(()=>alert("فشل الإرسال"));
  });
}
</script>

</body>
</html>
