<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>MAWARAN CO</title>

<style>
body{
  font-family:tahoma;
  background:linear-gradient(135deg,#e9eef3,#f7f9fc);
  margin:0;
}
.container{
  max-width:420px;
  margin:auto;
  background:#fff;
  padding:16px;
  border-radius:16px;
  box-shadow:0 10px 25px rgba(0,0,0,.12);
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.langBtn{
  background:#eee;
  border:0;
  border-radius:50%;
  width:40px;
  height:40px;
  font-size:20px;
}
h2{text-align:center;margin:10px 0}
label{display:block;margin-top:10px;font-weight:bold}
input,select,textarea,button{
  width:100%;
  padding:10px;
  margin-top:4px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:16px;
}
input.error,select.error,textarea.error{
  border-color:red;
  background:#ffecec;
}
button{
  background:#0a7cff;
  color:#fff;
  border:0;
  margin-top:16px;
}
#msg{text-align:center;margin-top:10px;font-weight:bold}
.hidden{display:none}

#topInfo{
  background:#f0f4ff;
  padding:10px;
  border-radius:10px;
  display:flex;
  align-items:center;
  gap:6px;
  flex-wrap:wrap;
  font-size:14px;
}
#topInfo b{color:#0a7cff}
#editBtn{
  background:#666;
  font-size:13px;
  padding:6px 10px;
}
#cityEdit{width:auto;padding:6px;font-size:14px}
</style>
</head>

<body>
<div class="container">

<header>
  <div></div>
  <button class="langBtn" onclick="toggleLang()">ğŸŒ</button>
</header>

<!-- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="login">
  <h2 data-t="login">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>

  <label data-t="repName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ *</label>
  <input id="repName">

  <label data-t="city">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© *</label>
  <input id="city">

  <button onclick="saveLogin()" data-t="enter">Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- Ø§Ù„ÙÙˆØ±Ù… -->
<div id="formBox" class="hidden">

  <div id="topInfo">
    <span data-t="rep">Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨:</span>
    <b id="repShow"></b> |
    <span data-t="city">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</span>
    <span id="cityShow"></span>
    <input id="cityEdit" class="hidden">
    <button id="editBtn" onclick="toggleEdit()" data-t="edit">ØªØ¹Ø¯ÙŠÙ„</button>
  </div>

  <h2>MAWARAN CO</h2>

  <label data-t="useOil">Ù‡Ù„ ÙŠÙ…ØªÙ„Ùƒ Ø²ÙŠØª Ø±ÙŠÙ…Ø§ÙƒØ³ *</label>
  <select id="useOil">
    <option value=""></option>
    <option>Ù†Ø¹Ù…</option>
    <option>Ù„Ø§</option>
  </select>

  <label data-t="tradeName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ *</label>
  <input id="tradeName">

  <label data-t="ownerName">Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ *</label>
  <input id="ownerName">

  <label data-t="address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† *</label>
  <input id="address">

  <label data-t="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
  <input id="phone">

  <label data-t="category">Ø§Ù„ÙØ¦Ø© *</label>
  <select id="category">
    <option value=""></option>
    <option>ÙƒØ±Ø§Ø¬</option>
    <option>Ø¬Ù…Ù„Ø©</option>
    <option>Ù…ÙØ±Ø¯</option>
  </select>

  <label data-t="note">Ù…Ù„Ø§Ø­Ø¸Ø©</label>
  <textarea id="note"></textarea>

  <label data-t="rate">Ø§Ù„ØªÙ‚ÙŠÙŠÙ… *</label>
  <select id="rate">
    <option value=""></option>
    <option value="1">â­</option>
    <option value="2">â­â­</option>
    <option value="3">â­â­â­</option>
    <option value="4">â­â­â­â­</option>
    <option value="5">â­â­â­â­â­</option>
  </select>

  <label data-t="visit">ÙƒÙ„ ÙƒÙ… ÙŠÙˆÙ… Ø²ÙŠØ§Ø±Ø© *</label>
  <input id="visitDays">

  <label>Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØª</label>
  <input id="oilType">

  <label>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø²ÙŠØª</label>
  <input id="oilGrade">

  <label>Ø§Ù„Ù…Ø³Ø§ÙØ©</label>
  <select id="oilDistance">
    <option value=""></option>
    <option>3 ÙƒÙ…</option>
    <option>5 ÙƒÙ…</option>
    <option>10 ÙƒÙ…</option>
  </select>

  <label>Ø³Ø¹Ø± Ø§Ù„Ù„ØªØ±</label>
  <input id="oilPrice">

  <button onclick="send()">Ø¥Ø±Ø³Ø§Ù„</button>
  <div id="msg"></div>
</div>

</div>

<script>
const URL="https://script.google.com/macros/s/AKfycbwbQkYePx5IvYev_Crtcv-6kXV4sTdGz6VhbSWsbNey7W4Vs3z4Y7kf8xAnH4D3KqXulQ/exec";

/* ===== login ===== */
if(localStorage.repName){
  login.classList.add("hidden");
  formBox.classList.remove("hidden");
  repShow.textContent=localStorage.repName;
  cityShow.textContent=localStorage.city;
  cityEdit.value=localStorage.city;
}

function saveLogin(){
  if(!repName.value||!city.value)return;
  localStorage.repName=repName.value;
  localStorage.city=city.value;
  location.reload();
}

let edit=false;
function toggleEdit(){
  edit=!edit;
  cityShow.classList.toggle("hidden",edit);
  cityEdit.classList.toggle("hidden",!edit);
  editBtn.textContent=edit?"Ø­ÙØ¸":"ØªØ¹Ø¯ÙŠÙ„";
  if(!edit){
    localStorage.city=cityEdit.value;
    cityShow.textContent=cityEdit.value;
  }
}

/* ===== send ===== */
function send(){
  const required=[useOil,tradeName,ownerName,address,phone,category,rate,visitDays];
  let ok=true;
  required.forEach(f=>{
    f.classList.remove("error");
    if(!f.value){f.classList.add("error");ok=false;}
  });
  if(!ok)return;

  msg.textContent="Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";

  const data={
    repName:localStorage.repName,
    city:localStorage.city,
    tradeName:tradeName.value,
    ownerName:ownerName.value,
    address:address.value,
    phone:phone.value,
    category:category.value,
    note:note.value,
    rate:rate.value,
    visitDays:visitDays.value,
    useOil:useOil.value,
    oilType:oilType.value,
    oilGrade:oilGrade.value,
    oilDistance:oilDistance.value,
    oilPrice:oilPrice.value,
    lat:"",
    lng:""
  };

  fetch(URL,{
    method:"POST",
    body:JSON.stringify(data),
    headers:{"Content-Type":"application/json"}
  })
  .then(r=>r.json())
  .then(res=>{
    if(res.status==="success"){
      msg.textContent="âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­";
      document.querySelectorAll("#formBox input,#formBox textarea").forEach(i=>i.value="");
      document.querySelectorAll("#formBox select").forEach(s=>s.value="");
    }else{
      msg.textContent="âŒ "+res.message;
    }
  })
  .catch(()=>{
    msg.textContent="âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„";
  });
}
</script>

</body>
</html>
